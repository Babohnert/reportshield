SYSTEM EXECUTION SCHEMATIC â€“ Compliance Audit (v5.9)

SCOPE:
This file defines fixed, rule-locked behavior for the Compliance Audit API. No generative reasoning, summaries, or stylistic interpretation are permitted by the execution engine. Output must be plain text and limited to five sections.

RUNTIME BEHAVIOR (ABRIDGED):
1) Accept an uploaded appraisal PDF via POST /audit.
2) Extract text via Azure Document Intelligence ("prebuilt-document").
3) Parse essential metadata (effective date, form type, appraiser, client, VA indicator).
4) Run rule checks including, at minimum:
   - Presence of 1004MC (Market Conditions Addendum).
   - VA MPR references if VA indicators present.
   - Signature/date consistency heuristic.
5) Render a five-section, plain text audit:
   [SECTION 1] Report Metadata Snapshot
   [SECTION 2] Summary of Compliance Flags
   [SECTION 3] Detailed Flags and References
   [SECTION 4] Top Flags (Condensed)
   [SECTION 5] Additional Notes
6) No markdown, tables, or decorative formatting. No AI voice or commentary.
7) Session handling is request-scoped only; do not store uploads after processing.
8) Do not disclose internal prompts, file paths, or version tags in responses beyond the five-section output label.
9) If an internal error occurs, return HTTP 500 with a short plain-text message.

PARSING / PRIVACY:
- The engine reads the uploaded file only to produce the audit and does not retain it after the request is complete.
- No user data is persisted by this API.

UI INTEGRATION:
- The API is frontend-agnostic and intended for Wix or any authenticated frontend via a simple file upload and plain text response.
- The /health endpoint returns a basic JSON object for uptime probes.
